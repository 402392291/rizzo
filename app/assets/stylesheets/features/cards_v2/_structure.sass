@mixin card-dimensions($span, $width: $card-width, $height: $card-height, $margin: $card-margin)
  $width: ($width * $span) + ($margin * ($span - 1))
  $ratio: (1 / $width) * $height

  padding-top: percentage($ratio)

  &.card--fixed
    width: $width + 0px
    padding-top: $height + 0px

.card
  @extend %rounded-corners
  position: relative
  margin-bottom: $card-margin
  background: #FFF

  .grid-wrapper--10 > &
    float: left
    margin-left: 10px

  .grid-wrapper--20 > &
    float: left
    margin-left: 20px

.card--single
  +card-dimensions(1)

.card--double
  +card-dimensions(2)

// -----------------------------------------------------------------------------
// Basic card layout and styles
// -----------------------------------------------------------------------------

.card__mask,
.card__figure,
.card__footer,
.card__content
  position: absolute
  top: 0
  left: 0
  right: 0
  bottom: 0

.card__mask
  @extend %rounded-corners
  overflow: hidden

.card__figure__img
  height: 100%

.card__content
  padding: $card-content-padding
  color: $body-copy

.card__content__pin
  .card--no-img &
    width: 24px
    height: 35px
    margin-bottom: 8px

.card__content__locale,
.card__content__context
  +font-size(13)
  margin-bottom: 4px
  color: $bodygray

  &:before
    display: inline-block
    vertical-align: middle

.card__content__locale
  margin-top: 6px

  &:before
    +size(10px)
    margin: -2px 2px 0 0

.card__content__context
  &:before
    +size(13px)
    +icon-color(white)
    margin: -4px 2px 0 0
    border-radius: 50%

    // Fake padding around the icon
    border: 2px solid
    background-size: 100%

.card__content__title
  +font-size(20)

.card__content__desc
  +font-size(15)
  margin: 10px 0 0
  line-height: 1.3
  color: $feature-copy

.card__footer
  +font-size(13)
  top: auto

  // A cheeky extra 1px to cover any seams or
  // artefacts on iDevices when zoomed out
  height: $card-footer-height + 1px
  padding: 0 15px
  color: $feature-copy

// -----------------------------------------------------------------------------
// Height variations
// -----------------------------------------------------------------------------

.card--tall

  &.card--has-img

    .card__content
      top: auto
      border-top: 0

    // Standard card
    &.card--standard

      .card__figure
        bottom: $card-content-height + nth($card-content-padding, 1) + nth($card-content-padding, 3)

      .card__content
        background: #FFF

      .card__content
        height: $card-content-height
        transition: height .2s ease-out

      &:hover
        .card__content
          height: $card-content-height + $card-content-hover-growth

      &.card--has-footer
        .card__content
          height: $card-content-height - $card-footer-height
          bottom: $card-footer-height

        .card__footer
          background: #FFF

        &:hover
          .card__content
            height: $card-content-height - $card-footer-height + $card-content-hover-growth

    // Cover image card
    &.card--cover

      .card__footer,
      .card__content
        color: #FFF

      .card__content
        padding-bottom: 15px
        transition: margin-bottom .2s ease-out

      .card__content__context
        color: inherit

      .card__content__title
        +font-size(24)

      .card__content__desc
        @extend %visually-hide

      &.card--double

        .card__figure__img
          width: 100%
          height: auto

        .card__content__title
          +font-size(28)

  &.card--no-img

    .card__content
      padding-top: 15px

.card--short
  // Short cards are always a single width
  +card-dimensions($span: 1, $height: $card-short-height)

  &.card--has-img

    // Short cards with an image should always act
    // as a cover image whether told to or not.
    .card__figure__img
      width: 100%
      height: auto

    .card__footer,
    .card__content
      color: #FFF

    .card__content
      top: auto
      border-top: 0

    .card__content__title
      +font-size(24)

    .card__content__desc
      @extend %visually-hide

// -----------------------------------------------------------------------------
// Paraphernalia
// -----------------------------------------------------------------------------

.card

  .card__footer

    .btn
      width: auto
      font-size: 100%
      margin: 0 -8px
      padding: 9px 10px

    .user-attribution
      font-size: 100%

    .text-icon
      &:before
        +size(16px)
        +icon-color(body-grey)

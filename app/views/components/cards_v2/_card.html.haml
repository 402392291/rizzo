:ruby

  attrs = {
    # Format
    cover?: false,
    short?: false,
    fixed?: false,
    double?: false,

    # Main content
    url: "",
    kind: "",
    title: "",
    description: "",

    # Image
    image_alt: nil,
    image_url: nil,
    image_license: nil,
    image_attribution: nil,
    image_attribution_link: nil,

    # Meta
    meta_avatar: nil,
    meta_author: nil,
    meta_description: nil,

    # Price tag
    price: nil,
    retail_price: nil,
    on_sale_here?: nil,
    currency_symbol: nil,

    # Other tags
    tag_position: nil,
    tag_lp_review: nil,
    tag_top_choice: nil
  }

  class_names = [
    "card",
    "js-card",
    "card--#{properties[:kind]}",
    "card--#{properties[:short?] ? 'short' : 'tall'}",
    "card--#{properties[:fixed?] ? 'fixed' : 'flexible'}",
    "card--#{properties[:cover?] ? 'cover' : 'standard'}",
    "card--#{properties[:double?] ? 'double' : 'single'}",
    "card--#{properties[:image_url] ? 'has-img' : 'no-img'}",
    "card--#{properties[:meta_description] ? 'has-meta' : 'no-meta'}"
  ].join(" ")

%article{ class: class_names }
  .card__mask

    %a{ href: properties[:url] }

      - if properties[:image_url]
        %figure.card__figure
          = safe_image_tag(properties[:image_url], class: "card__figure__img", alt: properties[:image_alt])

      .card__content

        .card__title
          = properties[:title]
        .card__desc
          = properties[:description]

      .card__meta

        - if properties[:meta_avatar] && properties[:meta_author]
          .card__meta__attribution
            = safe_image_tag(properties[:meta_avatar], class: "card__meta__avatar", alt: "Avatar for #{properties[:meta_author]}")
            by
            %span.card__meta__author
              = properties[:meta_author]
        - elsif properties[:meta_description]
          .card__meta__kind{ class: "card__meta__kind--#{properties[:kind]}" }
            %span.card__meta__icon{ class: "icon--#{properties[:kind]}" }
            = properties[:meta_description]

  .card__tags
    - if properties[:price]
      = render :partial => "/components/cards_v2/partials/price_tag", :locals => { :properties => properties }
    = render :partial => "/components/cards_v2/partials/tags", :locals => { :properties => properties }
